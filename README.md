# Nested GLM
Python codes to implement the nested GLM to model the auto insurance frequqncy using Poisson GLM a real-life Brazil auto insurance dataset.
# Description
Generalized linear model (GLM) is a popular choice for pricing non-life insurance policies. However, the high-cardinality categorical rating variables in non-life insurance pose significant challenges for GLM. Furthermore, insurance regulators often require the location-related categorical variable to be transformed into a lower-dimension contiguous Territory variable. Motivated by these challenges, this paper proposes a nested GLM framework for non-life insurance ratemaking applications. In this framework, a neural network model with categorical embedding layers effectively translates categorical variables into meaningful numerical representations. Of these, the ones corresponding to the location-related variable are further converted into a contiguous Territory rating variable via spatial-constraint clustering models. Incorporating outcomes from these models, the nested GLM satisfies regulatory requirements, and enhances the modelâ€™s predictive power, while maintaining the interpretability from the (generalized) linear form. The construction and performance of a nested Poisson GLM are demonstrated using a real-life Brazil auto insurance data to model claim frequency. 
